2025-07-27 21:43:28,456 - pipeline_app - general_logger - INFO - Iniciando webhook
2025-07-27 21:48:58,432 - pipeline_app - general_logger - WARNING - Falha na validação dos dados: Erro ao analisar os dados: As chaves 'key' e 'side' são obrigatórias
2025-07-27 21:49:11,072 - pipeline_app - general_logger - ERROR - Erro ao enviar task ao Celery: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente
2025-07-27 21:49:11,072 - pipeline_app - general_logger - ERROR - Erro inesperado no processamento do webhook
Traceback (most recent call last):
  File "C:\Project\env\venv\Lib\site-packages\kombu\utils\functional.py", line 32, in __call__
    return self.__value__
           ^^^^^^^^^^^^^^
AttributeError: 'ChannelPromise' object has no attribute '__value__'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Project\env\venv\Lib\site-packages\kombu\connection.py", line 472, in _reraise_as_library_errors
    yield
  File "C:\Project\env\venv\Lib\site-packages\kombu\connection.py", line 459, in _ensure_connection
    return retry_over_time(
           ^^^^^^^^^^^^^^^^
  File "C:\Project\env\venv\Lib\site-packages\kombu\utils\functional.py", line 318, in retry_over_time
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Project\env\venv\Lib\site-packages\kombu\connection.py", line 938, in _connection_factory
    self._connection = self._establish_connection()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Project\env\venv\Lib\site-packages\kombu\connection.py", line 860, in _establish_connection
    conn = self.transport.establish_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Project\env\venv\Lib\site-packages\kombu\transport\pyamqp.py", line 203, in establish_connection
    conn.connect()
  File "C:\Project\env\venv\Lib\site-packages\amqp\connection.py", line 324, in connect
    self.transport.connect()
  File "C:\Project\env\venv\Lib\site-packages\amqp\transport.py", line 132, in connect
    self._connect(self.host, self.port, self.connect_timeout)
  File "C:\Project\env\venv\Lib\site-packages\amqp\transport.py", line 187, in _connect
    self.sock.connect(sa)
ConnectionRefusedError: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Project\github\deux-backend\webhookReceiver\pipeline_app.py", line 52, in send_to_celery
    celery_app.send_task("process_webhook", kwargs={"data": data}, queue="webhook")
  File "C:\Project\env\venv\Lib\site-packages\celery\app\base.py", line 801, in send_task
    amqp.send_task_message(P, name, message, **options)
  File "C:\Project\env\venv\Lib\site-packages\celery\app\amqp.py", line 518, in send_task_message
    ret = producer.publish(
          ^^^^^^^^^^^^^^^^^
  File "C:\Project\env\venv\Lib\site-packages\kombu\messaging.py", line 190, in publish
    return _publish(
           ^^^^^^^^^
  File "C:\Project\env\venv\Lib\site-packages\kombu\connection.py", line 556, in _ensured
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Project\env\venv\Lib\site-packages\kombu\messaging.py", line 200, in _publish
    channel = self.channel
              ^^^^^^^^^^^^
  File "C:\Project\env\venv\Lib\site-packages\kombu\messaging.py", line 224, in _get_channel
    channel = self._channel = channel()
                              ^^^^^^^^^
  File "C:\Project\env\venv\Lib\site-packages\kombu\utils\functional.py", line 34, in __call__
    value = self.__value__ = self.__contract__()
                             ^^^^^^^^^^^^^^^^^^^
  File "C:\Project\env\venv\Lib\site-packages\kombu\messaging.py", line 240, in <lambda>
    channel = ChannelPromise(lambda: connection.default_channel)
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Project\env\venv\Lib\site-packages\kombu\connection.py", line 957, in default_channel
    self._ensure_connection(**conn_opts)
  File "C:\Project\env\venv\Lib\site-packages\kombu\connection.py", line 458, in _ensure_connection
    with ctx():
  File "C:\Users\theze\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 155, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Project\env\venv\Lib\site-packages\kombu\connection.py", line 476, in _reraise_as_library_errors
    raise ConnectionError(str(exc)) from exc
kombu.exceptions.OperationalError: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Project\github\deux-backend\webhookReceiver\pipeline_app.py", line 73, in webhook_listener
    send_to_celery(parsed_data)
  File "C:\Project\github\deux-backend\webhookReceiver\pipeline_app.py", line 56, in send_to_celery
    raise RuntimeError("Falha ao enviar para processamento assíncrono.")
RuntimeError: Falha ao enviar para processamento assíncrono.
2025-07-27 21:49:43,135 - pipeline_app - general_logger - INFO - Iniciando webhook
